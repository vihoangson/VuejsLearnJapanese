<template>    <div class="modal-group">        <b-modal            id="modal-prevent-group"            ref="modal"            title="Create a new Group Chat"            @show="resetModal"            @hidden="resetModal"            @ok="handleOk">            <form ref="form" class="form-groups">                <div class="row">                    <div class="col-md-3">                         <div class="form-group">                            <label class="label-left">Category name:</label>                        </div>                    </div>                    <div class="col-md-9">                        <div class="form-group">                            <input type="hidden" name="userId" v-model="userId" class="form-control" >                            <input type="text" name="groupName" v-model="groupName" class="form-control " >                            <div class="error"></div>                        </div>                    </div>                </div>                <div class="row">                    <div class="col-md-3">                        <div class="form-group">                            <label  class="label-left">Choose chat:</label>                        </div>                    </div>                    <div class="col-md-9">                        <div class="form-group searchRoom">                            <span class="icSearch">                                <svg viewBox="0 0 10 10" class="icSearch" width="16" height="16">                                    <use fill-rule="evenodd" xlink:href="#icon_search"></use>                                </svg>                            </span>                            <span class="inputSearch">                                <input type="text" id="ContactFilter" class="form-control" v-model="search" placeholder="Search by name">                            </span>                        </div>                    </div>                </div>                <div class="row">                    <div class="col-md-3">                    </div>                    <div class="col-md-9">                        <div class="form-group">                            <div class="MemberSelect">                                <div id="SelectAllBtn" class="memberTableCheckAll" >                                    <input id="checkAll" name="checkAll" type="checkbox" v-model="selectAll" @click="select">                                    <label for="checkAll" class="linkStatus" >Number of selected chats:</label>                                </div>                                <div class="table-scroll">                                    <table class="table table-group">                                        <tr v-for='item in filteredItems'>                                            <td width="5%"><input type="checkbox" :value="item.id" v-model="selected"></td>                                            <td width="10%" class="avatar">                                                <img v-bind:src="item.icon_img">                                            </td>                                            <td width="90%" class="persion">                                                <p class="member">                                                    <span class="name">{{item.name}}</span>                                                </p>                                            </td>                                        </tr>                                    </table>                                </div>                            </div>                        </div>                    </div>                </div>            </form>            <div slot="modal-footer" class="w-100">                <b-button variant="outline-secondary"  :disabled="!(selected.length > 0) || (groupName.length == 0)" size="md" @click="btnCreate"> Create </b-button>                <b-button variant="outline-secondary" size="md" @click="btnCancel"> Cancel </b-button>            </div>        </b-modal>    </div></template><style>    .modal-dialog{        max-width: 55%;    }    .modal-title{        font-weight: 600;    }    .modal-content{        background: #F7f7f7;    }    .form-group{        margin-bottom: 10px;;    }    .form-group label{        font-size: 13px;        font-weight: normal;        line-height: 18px;        color: #666666;    }    .form-groups .searchRoom{        position: relative;    }    .form-groups .searchRoom .icSearch{        position: absolute;        top: 5px;        left: 3px;    }    .searchRoom .inputSearch input{        padding-left: 30px;    }    .form-control {        font-size: 14px;    }    input[type="checkbox"] {        position: relative;        top: 1px;        width: 15px;        height: 15px;    }    .memberTableCheckAll{        justify-content: center;        border-style: solid;        border-width: 1px;        border-radius: 2px;        border-color: #b3b3b3;        text-decoration: none;        cursor: pointer;        padding: 5px 10px;        font-size: 13px;        background-color: #f5f5f4;        margin-right: 10px;        display: inline-block;        height: 30px;        width: 100%;    }    #checkAll{        position: relative;        top: 1px;    }    .memberTableCheckAll label{        margin-left: 3px;        position: relative;        top: -1px;    }    .table-scroll{        max-height: 300px;        overflow-y: scroll;        display: block;        border: 1px #b3b3b3 solid;    }    .table-group tr{        width: 100%;    }    .table-group tr td{        padding: 10px;        padding-bottom: 0;        padding-top: 15px;    }    .table-group .avatar{        width: 40px;    }    .table-group .avatar img{        width: 20px;        height: auto;        position: relative;        top: -3px;    }    .modal-footer{        text-align: center;    }    .form-group .label-left{        font-weight: bold;        position: relative;        top: 5px;        font-size: 16px;    }</style><script>    import modalMixin from '@/mixins/modal'    import axios from 'axios'    export default {        name: "Group",        mounted() {            this.$root.$on('modal-prevent-id', data => {               this.groupId = data;               if(data != 0){                    this.selected = [];                    this.getGroupById(data).then(response => {                        this.groupName = response.name;                    });                    this.getRoomByGroupId(data).then(response => {                        for (var i = 0; i < this.items.length; i++) {                            for (var j = 0; j < response.length; j++) {                                if(this.items[i].id == response[j].id){                                    this.selected.push(this.items[i].id);                                    break;                                }                            }                        }                    });                }            })        },        data() {            return {                name: '',                nameState: null,                submittedNames: [],                isActive : false,                selectItem: "Edit all permissions",                subscriptions: [{id:1,name:'Admin'},{id:2,name:'Member'},{id:3,name:'Readonly'}],                activeIndex: undefined,                search: "",                items: [],                selected: [],                selectAll: false,                groupName: "",                userId: 1,                description: "",                groupId: 0,            }        },        created: function(){            this.getAllRooms().then(response => {                this.items = response;            });        },        computed: {            filteredItems() {                if(this.items.length > 0){                    this.selected = [];                    return this.items.filter(item => {                        return item.name.toLowerCase().indexOf(this.search.toLowerCase()) > -1                    });                }                return [];            }        },        methods: {            select() {                this.selected = [];                if (!this.selectAll) {                    for (let i in this.items) {                        this.selected.push(this.items[i].id);                    }                }            },            setActive(index, criptions) {                this.activeIndex = index;                this.selectItem = criptions;            },            getAllRooms(){                return axios.get("http://sns-api.local.vn:81/api/v1/group/getAllRooms", {                },{                    headers: {Accept: "application/json"}                }).then(function (response) {                    return response.data;                }).catch(function (error) {                    return null;                });            },            getGroupById(id){                return axios.get("http://sns-api.local.vn:81/api/v1/group/getGroupById/"+id, {                },{                    headers: {Accept: "application/json"}                }).then(function (response) {                    return response.data;                }).catch(function (error) {                    return null;                });            },            getRoomByGroupId(id){                return axios.get("http://sns-api.local.vn:81/api/v1/group/getRoomByGroupId/"+id, {                },{                    headers: {Accept: "application/json"}                }).then(function (response) {                    return response.data;                }).catch(function (error) {                    return null;                });            },            btnCancel(){                this.$refs.modal.hide();            },            btnCreate() {                // Exit when the form isn't valid                console.log(this.groupId);                if(this.groupId == 0){                    //let token = JSON.parse(localStorage.getItem('user')).token;                    axios.post("http://sns-api.local.vn:81/api/v1/group/add", {                        groupName: this.groupName,                        userId: this.userId,                        selected: this.selected,                        only_token: true,                    },{                        //headers: {Authorization: "Bearer " + token}                    }).then(function (response) {                        console.log(response);                    }).catch(function (error) {                        console.log(error);                    });                    // Push the name to submitted names                    this.submittedNames.push(this.name)                    // Hide the modal manually                    this.$nextTick(() => {                        this.$refs.modal.hide();                    })                }else{                    //let token = JSON.parse(localStorage.getItem('user')).token;                    axios.post("http://sns-api.local.vn:81/api/v1/group/update", {                        id: this.groupId,                        groupName: this.groupName,                        userId: this.userId,                        selected: this.selected,                        only_token: true,                    },{                        //headers: {Authorization: "Bearer " + token}                    }).then(function (response) {                        console.log('this.selected')                        console.log(response);                    }).catch(function (error) {                        console.log(error);                    });                    // Push the name to submitted names                    this.submittedNames.push(this.name)                    // Hide the modal manually                    this.$nextTick(() => {                        this.$refs.modal.hide();                    });                }            },            resetModal() {                this.name = ''                this.nameState = null            },            handleOk(bvModalEvt) {                bvModalEvt.preventDefault()                this.handleSubmit()            },        }    }</script>
<template>    <div class="modal-group">        <b-modal            id="modal-prevent-rooms"            ref="modal"            title="Create a new Group Chat"            @show="resetModal"            @hidden="resetModal"            @ok="handleOk">            <form ref="form" class="form-rooms">                <div class="row">                    <div class="col-md-3">                        <div class="roomInfo">                            <img id="roomInfoImage" class="roomInfoImage" src="https://appdata.chatwork.com/icon/ico_group.png" alt="">                            <div id="roomIconChange" class="roomIconChange">Change</div>                            <input type="hidden" name="roomImage" v-model="roomImage">                        </div>                    </div>                    <div class="col-md-9">                        <div class="form-group">                            <label>Group Chat Name:</label><div class="error"></div>                            <input type="text" name="roomName" v-model="roomName" class="form-control" placeholder="Group name">                        </div>                        <div class="form-group">                            <label>Group Chat Name:</label> <div class="error"></div>                            <textarea name="description" v-model="description" id="Description" class="form-control" placeholder="Add chat description, notes, or links here."></textarea>                        </div>                    </div>                    <div class="col-md-12 clearfix">                        <div class="searchRoom">                            <span class="icSearch">                                <svg viewBox="0 0 10 10" class="icSearch" width="16" height="16">                                    <use fill-rule="evenodd" xlink:href="#icon_search"></use>                                </svg>                            </span>                            <span class="icCancel" style="display:none">                                <svg viewBox="0 0 10 10" class="icSearchCancel" width="16" height="16">                                  <use fill-rule="evenodd" xlink:href="#icon_cancel"></use>                                </svg>                            </span>                            <span class="inputSearch">                                <input type="text" id="ContactFilter" class="form-control"  v-model="search" placeholder="Search by name">                            </span>                        </div>                    </div>                </div>                <div class="row">                    <div class="col-md-12">                        <div class="MemberSelect">                            <div id="SelectAllBtn" class="memberTableCheckAll" >                                <input id="checkAll" name="checkAll" type="checkbox"  v-model="selectAll" @click="select">                                <label for="checkAll" class="linkStatus" >Check All</label>                            </div>                            <ul id="OrganizationFilter" class="roomMemberSelect" role="radiogroup">                                <li class="roomMemberSelect">                                    <input type="radio" id="InfoOrganizeFilter" value="all" name="org_filter">                                    <label for="InfoOrganizeFilter"> Show all </label>                                </li>                                <li class="roomMemberSelect">                                    <input type="radio" id="InfoOrganized" value="organized" name="org_filter">                                    <label for="InfoOrganized">Show only within organization</label>                                </li>                            </ul>                            <div class="roomMemberSelect__commonRoleContainer">                                <div id="roomInfoSelectRole" class="selectCommonRole">                                    <div v-bind:class="{active: isActive, cwTextUnselectable: true}" @click="selectBoxClick">                                        <div class="selectboxDefault">                                              <span class="selectbox"> {{ selectItem }} </span>                                              <span class="icon">                                                <svg viewBox="0 0 10 10" width="16" height="16" >                                                  <use fill-rule="evenodd" xlink:href="#icon_triangleDown"></use>                                                </svg>                                              </span>                                        </div>                                        <ul role="list" class="selectboxContent">                                            <li v-for="(s, index) in subscriptions"                                                :class="{ 'active': activeIndex === index}" :key="s.id"                                                @click="setActive(index, s.name)">                                                {{ s.name }}                                            </li>                                        </ul>                                    </div>                                </div>                            </div>                            <div class="table-scroll">                                <table class="table table-group">                                    <tr v-for='item in filteredItems'>                                        <td><input type="checkbox" :value="item.id" v-model="selected"></td>                                        <td class="avatar">                                            <img width="10" v-bind:src="item.icon_img">                                        </td>                                        <td class="persion">                                            <p class="member">                                                <span class="name">{{item.name}}</span>                                            </p>                                        </td>                                        <td>                                            <p>                                                <span class="company">{{item.company}}</span>                                                <span class="selectRole">                                                    <div class="selectDefault">                                                          <span class="selectbox" @click="itemRoleRoomClick($event)"> {{ subscriptionsRoom[0].name }} </span>                                                          <span class="icon">                                                            <svg viewBox="0 0 10 10" width="16" height="16" >                                                              <use fill-rule="evenodd" xlink:href="#icon_triangleDown"></use>                                                            </svg>                                                          </span>                                                    </div>                                                    <ul role="list" class="selectContent">                                                        <li v-for="(s, index) in subscriptionsRoom"                                                            :class="{ 'active': activeIndex === index}" :key="s.id"                                                            @click="setActiveItem(index, s.name, item.id)">                                                            {{ s.name }}                                                        </li>                                                    </ul>                                                </span>                                            </p>                                        </td>                                        <td></td>                                    </tr>                                </table>                            </div>                        </div>                    </div>                </div>            </form>            <div slot="modal-footer" class="w-100">                <b-button variant="outline-secondary"  :disabled="!(selected.length > 0) || (roomName.length == 0)" size="md" @click="btnCreateRoom">{{buttonName}}</b-button>                <b-button variant="outline-secondary" size="md" @click="btnCancel"> Cancel </b-button>            </div>        </b-modal>    </div></template><style>    .selectRole{        float: right;        position: relative;    }    .selectRole .selectDefault{        border: 1px #ccc solid;        position: absolute;        top: -5px;        display: inline-block;        width: 150px;        right: -20px;    }    .selectRole .selectDefault .selectbox{        width: 100%;        display: inline-block;        padding: 2px 10px;    }    .selectRole .selectDefault .icon{        position: absolute;        right: 5px;        top: 1px;    }    .selectRole .selectContent{        position: absolute;        right: -20px;        background: #fff;        width: 150px;        border: 1px #ccc solid;        padding: 0;        list-style: none;        top: 22px;        z-index: 10;        display: none;    }    .selectRole.active .selectContent{        display: block;    }    .selectRole .selectContent li{        padding-left: 6px;        font-size: 13px;    }    .modal-dialog{        max-width: 55%;    }    .modal-title{        font-weight: 600;    }    .modal-content{        background: #F7f7f7;    }    .form-group{        margin-bottom: 10px;;    }    .form-group label{        font-size: 13px;        font-weight: normal;        line-height: 18px;        color: #666666;    }    .form-rooms .roomInfo{        border-radius: 5px;        position: relative;        -ms-flex-negative: 0;        flex-shrink: 0;    }    .form-rooms .roomInfoImage{        width: 100%;        border-radius: 5px;        max-width: 175px;    }    .form-rooms .roomIconChange{        position: absolute;        bottom: 0;        width: 100%;        height: 30px;        color: #fff;        border-radius: 0 0 5px 5px;        background: rgba(0, 0, 0, 0.8);        line-height: 30px;        text-align: center;        cursor: pointer;        max-width: 175px;    }    .form-rooms .form-group label {        vertical-align: top;        margin-right: 10px;    }    .form-rooms .searchRoom{        position: relative;    }    .form-rooms .searchRoom .icSearch{        position: absolute;        top: 5px;        left: 4px;    }    .form-rooms .searchRoom .inputSearch input{        padding-left: 30px;        padding-top: 8px;        margin: 5px 0;    }    .form-rooms .form-control {        font-size: 14px;    }    .form-rooms .memberTableCheckAll{        align-items: center;        justify-content: center;        border-style: solid;        border-width: 1px;        border-radius: 2px;        border-color: #b3b3b3;        text-decoration: none;        cursor: pointer;        padding: 5px 15px;        line-height: 26px;        font-size: 13px;        background-color: #f5f5f4;        margin-right: 10px;        display: inline-block;        height: 35px;        width: 120px;    }    .form-rooms #checkAll{        position: relative;        top: 2px;        height: 15px;        width: 15px;    }    .form-rooms input[type="radio"], input[type="checkbox"] {        position: relative;        top: 2px;        height: 15px;        width: 15px;    }    .form-rooms .MemberSelect{        padding: 10px;        background: #fff;        border: 1px #b3b3b3 solid;        border-radius: 2px;        position: relative;    }    .form-rooms .roomMemberSelect{        display: inline-block;        padding: 0;        margin-bottom: 5px;    }    .form-rooms .roomMemberSelect li{        display: inline-block;        padding-left: 15px;        font-size: 14px;    }    .form-rooms .roomMemberSelect input{        position: relative;        top: 3px;        margin-right: 3px;        height: 15px;        width: 15px;    }    .form-rooms .selectboxDefault{        position: absolute;        right: 20px;        top: 15px;        align-items: center;        justify-content: center;        border-style: solid;        border-width: 1px;        border-radius: 2px;        text-decoration: none;        cursor: pointer;        user-select: none;        padding: 0px 12px;        line-height: 26px;        font-size: 13px;        border-color: #b3b3b3;        background-color: #fff;        width: 200px;    }    .form-rooms .selectboxDefault .icon {        top: 0;        width: 10px;        display: inline-block;        position: absolute;        right: 15px;    }    .form-rooms .selectboxContent{        display: none;        position: absolute;        right: 0;        top: 42px;        z-index: 10;        right: 20px;        font-size: 13px;        width: 200px;        list-style: none;        border: 1px #b6b6b6 solid;        padding: 0;        background: #fff;        -webkit-box-shadow: 1px 2px 5px -3px rgba(0,0,0,0.75);        -moz-box-shadow: 1px 2px 5px -3px rgba(0,0,0,0.75);        box-shadow: 1px 2px 5px -3px rgba(0,0,0,0.75);        cursor: pointer;    }    .form-rooms .active .selectboxContent{        display: inline-block;    }    .form-rooms .selectboxContent li:hover{        background: #0a8abd;        color: #fff;        transition: .5s;    }    .form-rooms .selectboxContent li{        padding: 3px;        padding-left: 12px;    }    .form-rooms .table-scroll{        height: 210px;        overflow-y: scroll;        display: block;        width: 100%;        font-size: 14px;    }    .form-rooms .table-group tr{        width: 100%;    }    .table-group tr td{        padding: 10px;        padding-bottom: 0;        padding-top: 15px;    }    .table-group .avatar{        width: 40px;    }    .table-group .avatar img{        width: 100%;        height: auto;        position: relative;        top: -3px;    }    .form-rooms .form-group textarea, .form-rooms .form-group input{        width: 100%;        display: inline-block;    }    .form-rooms .form-group textarea{        height: 80px;    }</style><script>    import modalMixin from '@/mixins/modal'    import axios from 'axios'    export default {        name: "Group",        data() {            return {                name: '',                nameState: null,                submittedNames: [],                items: [],                search: "",                isActive : false,                activeIndex: undefined,                selectItem: "Edit all permissions",                subscriptions: [{id:1,name:'Admin'},{id:2,name:'Member'},{id:3,name:'Readonly'}],                subscriptionsRoom: [{id:1,name:'Admin'},{id:2,name:'Member'},{id:3,name:'Readonly'}],                selected: [],                selectAll: false,                roomId: 0,                roomName: "",                roomImage: "",                description: "",                buttonName:"",            }        },        created: function(){            this.items = this.getAllUser().then(data => {                this.items = data;            });        },        computed: {            filteredItems() {                if(this.items.length > 0){                    return this.items.filter(item => {                        return item.name.toLowerCase().indexOf(this.search.toLowerCase()) > -1                    });                }                return [];            }        },        methods: {            select() {                this.selected = [];                if (!this.selectAll) {                    for (let i in this.items) {                        this.selected.push(this.items[i].id);                    }                }            },            itemRoleRoomClick(event){                event.target.parentElement.parentElement.classList.toggle('active');            },            selectBoxClick(){                if(this.isActive){                    this.isActive = false;                }else{                    this.isActive = true;                }            },            setActive(index, criptions) {                this.activeIndex = index;                this.selectItem = criptions;            },            setActiveItem(index, value, id){                //selectItemRoom.[item] =  data;                //var arrayRoleRoom = {id: id, index:index, value: value}                //this.selectItemRoom.push(arrayRoleRoom);            },            checkFormValidity() {                const valid = this.$refs.form.checkValidity()                this.nameState = valid ? 'valid' : 'invalid'                return valid            },            resetModal() {                this.name = ''                this.nameState = null            },            handleOk(bvModalEvt) {                bvModalEvt.preventDefault()                this.handleSubmit()            },            getAllUser(){                return axios.get("http://sns-api.local.vn:81/api/v1/room/getAllUser", {                },{                    //headers: {Authorization: "Bearer " + token}                }).then(function (response) {                   return response.data;                }).catch(function (error) {                   return null;                });            },            btnCancel(){            },            btnCreateRoom() {                if(this.roomId == 0){                    if (!this.checkFormValidity()) {                        return                    }                    var res = axios.post("http://sns-api.local.vn:81/api/v1/room/add", {                        roomName: this.roomName,                        roomImage: this.roomImage,                        description: this.description,                        selected: this.selected,                        only_token: true,                    },{                        //headers: {Authorization: "Bearer " + token}                    }).then(function (response) {                        return response;                    }).catch(function (error) {                        return error;                    });                    res.then(response => {                        switch(parseInt(response.data.error_code)){                            case 0:                                this.$refs.modal.hide();                                this.$root.$emit('push-notice', {message:'insert success', alert: 'alert-success'});                            break;                            case 1:                                this.roomNameError = response.data.error_msg;                                break;                            case 2:                                this.roomselectedError = response.data.error_msg;                                break;                            case 3:                               break;                            break;                            default:                            break                        }                    });                }else{                    if (!this.checkFormValidity()) {                        return                    }                    var res = axios.post("http://sns-api.local.vn:81/api/v1/room/update", {                        id: this.roomId,                        groomName: this.roomName,                        roomImage: this.roomImage,                        description: this.description,                        selected: this.selected,                        only_token: true,                    },{                        //headers: {Authorization: "Bearer " + token}                    }).then(function (response) {                        return response;                    }).catch(function (error) {                        return error;                    });                    res.then(response => {                        switch(parseInt(response.data.error_code)){                            case 0:                               this.$refs.modal.hide();                               this.$root.$emit('push-notice', {message:'Update success', alert: 'alert-success'});                            break;                            case 1:                                console.log(response.data);                                this.roomNameError = response.data.error_msg;                                break;                            case 2:                                console.log(response.data);                                this.roomselectedError = response.data.error_msg;                                break;                            case 3:                               break;                            break;                            default:                            break                        }                    });                }            }        }    }</script>